# ğŸ¬ POPFLIX APP - CÃ“MO SE VE "EN TUS PLATAFORMAS"

## ğŸ“± VISUALIZACIÃ“N EN LA APP

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    POPFLIX                    ğŸ”           â•‘
â•‘                                                             â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ ğŸ“± PelÃ­culas Trending                                â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”          â”‚  â•‘
â•‘  â”‚ â”‚IMG â”‚ â”‚IMG â”‚ â”‚IMG â”‚ â”‚IMG â”‚ â”‚IMG â”‚ â”‚IMG â”‚  ğŸ‘ˆ Scroll  â”‚  â•‘
â•‘  â”‚ â”‚ 1  â”‚ â”‚ 2  â”‚ â”‚ 3  â”‚ â”‚ 4  â”‚ â”‚ 5  â”‚ â”‚ 6  â”‚          â”‚  â•‘
â•‘  â”‚ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜          â”‚  â•‘
â•‘  â”‚                                                      â”‚  â•‘
â•‘  â”‚ ğŸ† Top PelÃ­culas                                    â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ 1. The Matrix     (8.7â­)                           â”‚  â•‘
â•‘  â”‚ 2. Inception      (8.8â­)                           â”‚  â•‘
â•‘  â”‚ 3. Avatar         (7.9â­)                           â”‚  â•‘
â•‘  â”‚ 4. Interstellar   (8.6â­)                           â”‚  â•‘
â•‘  â”‚ 5. Dark Knight    (9.0â­)                           â”‚  â•‘
â•‘  â”‚                                                      â”‚  â•‘
â•‘  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚  â•‘
â•‘  â”‚                                                      â”‚  â•‘
â•‘  â”‚ ğŸ“± EN TUS PLATAFORMAS  â­ NUEVA SECCIÃ“N            â”‚  â•‘
â•‘  â”‚ Disponibles para ti                                 â”‚  â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â•‘
â•‘  â”‚ â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”                               â”‚  â•‘
â•‘  â”‚ â”‚IMG â”‚ â”‚IMG â”‚ â”‚IMG â”‚  ğŸ‘ˆ Solo pelÃ­culas            â”‚  â•‘
â•‘  â”‚ â”‚ A  â”‚ â”‚ B  â”‚ â”‚ C  â”‚     de plataformas que      â”‚  â•‘
â•‘  â”‚ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜     seleccionÃ³ el usuario     â”‚  â•‘
â•‘  â”‚                                                      â”‚  â•‘
â•‘  â”‚ PelÃ­cula A - Netflix  (7.5â­)                       â”‚  â•‘
â•‘  â”‚ PelÃ­cula B - Disney+  (8.2â­)                       â”‚  â•‘
â•‘  â”‚ PelÃ­cula C - HBO      (8.0â­)                       â”‚  â•‘
â•‘  â”‚                                                      â”‚  â•‘
â•‘  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚  â•‘
â•‘  â”‚                                                      â”‚  â•‘
â•‘  â”‚ ğŸ“‚ EXPLORAR POR GÃ‰NERO                              â”‚  â•‘
â•‘  â”‚ Drama | Action | Comedy | ...                       â”‚  â•‘
â•‘  â”‚                                                      â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                             â•‘
â•‘  [ ğŸ  Home ]  [ ğŸ” Explore ]  [ ğŸ‘¤ Profile ]             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ¯ FLUJO COMPLETO

### 1ï¸âƒ£ **Usuario inicia sesiÃ³n**
```
Usuario abre PopFlix
         â†“
Ingresa credenciales (email + contraseÃ±a)
         â†“
Usuario 2 (usuario de prueba)
         â†“
App lo autentica (AuthContext)
```

### 2ï¸âƒ£ **App carga datos**
```
Pantalla HOME se renderiza
         â†“
useEffect(() => {
  loadData()  â† Llama a 4 endpoints
})
         â†“
Endpoints llamados:
  âœ… /api/movies/trending
  âœ… /api/movies/ranking  
  âœ… /api/movies/genre/:id
  âœ… /api/movies/user/2/by-platforms â† NUEVA
```

### 3ï¸âƒ£ **Endpoint filtra por plataformas**
```
GET /api/movies/user/2/by-platforms?page=1

Backend:
  1. Obtiene plataformas de user_2 â†’ [3, 1] (Disney+, Netflix)
  2. Query: SELECT m.* FROM movies m
            INNER JOIN movies_platforms mp
            WHERE mp.platform_id IN (3, 1)
  3. Retorna pelÃ­culas de esas plataformas
  
Response:
{
  "movies": [
    { "id": 123, "title": "PelÃ­cula 1", "rating": 8.5, ... },
    { "id": 456, "title": "PelÃ­cula 2", "rating": 7.9, ... },
    ...
  ],
  "count": 15,
  "page": 1
}
```

### 4ï¸âƒ£ **App renderiza secciÃ³n**
```
const [platformMovies, setPlatformMovies] = useState<Movie[]>([]);

// En loadData():
const platformRes = await fetch(
  `http://172.20.10.2:9999/api/movies/user/2/by-platforms?page=1`
);
const platformData = await platformRes.json();
setPlatformMovies(platformData.movies || []);

// En render:
{platformMovies.length > 0 && (
  <View>
    <Text>En tus plataformas</Text>
    <Text>Disponibles para ti</Text>
    <ScrollView horizontal>
      {platformMovies.slice(0, 6).map(movie => (
        <MovieCard movie={movie} onPress={...} />
      ))}
    </ScrollView>
  </View>
)}
```

### 5ï¸âƒ£ **Usuario ve la secciÃ³n**
```
[HOME SCREEN]
â”‚
â”œâ”€ ğŸ“± PelÃ­culas Trending
â”‚  â”œâ”€ [PelÃ­cula 1] [PelÃ­cula 2] [PelÃ­cula 3] ...
â”‚
â”œâ”€ ğŸ† Top PelÃ­culas (Ranking)
â”‚  â”œâ”€ 1. The Matrix (8.7â­)
â”‚  â”œâ”€ 2. Inception (8.8â­)
â”‚  â””â”€ ...
â”‚
â”œâ”€ ğŸ“± EN TUS PLATAFORMAS â­ NUEVA
â”‚  â”œâ”€ Disponibles para ti
â”‚  â”œâ”€ [PelÃ­cula A] [PelÃ­cula B] [PelÃ­cula C]
â”‚  â”‚   Netflix        Disney+        HBO Max
â”‚  â”‚   (7.5â­)        (8.2â­)         (8.0â­)
â”‚  â”‚
â”‚  â””â”€ Datos REALES filtrados por plataformas seleccionadas
â”‚
â””â”€ ğŸ“‚ Explorar por GÃ©nero
   â”œâ”€ Drama | Action | Comedy | ...
```

---

## ğŸ’¾ DATOS ESPECÃFICOS - USUARIO 2

### Base de Datos Actual

**User 2 tiene seleccionadas:**
- Platform 3: Disney+
- Platform 1: Netflix

**PelÃ­culas disponibles en esas plataformas:**

```sql
-- 15 pelÃ­culas de Netflix
SELECT COUNT(*) FROM movies_platforms 
WHERE platform_id = 1;  -- 15 resultados

-- 2 pelÃ­culas de Disney+
SELECT COUNT(*) FROM movies_platforms 
WHERE platform_id = 3;  -- 2 resultados

-- TOTAL: 17 pelÃ­culas para Usuario 2
```

### Ejemplo de Lo Que Se MostrarÃ¡

```
EN TUS PLATAFORMAS
Disponibles para ti

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚
â”‚  [POSTER]       â”‚  â”‚  [POSTER]       â”‚  â”‚  [POSTER]       â”‚
â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚
â”‚ The Matrix      â”‚  â”‚ Matrix 2        â”‚  â”‚ Avatar          â”‚
â”‚ Netflix         â”‚  â”‚ Netflix         â”‚  â”‚ Disney+         â”‚
â”‚ 8.7â­           â”‚  â”‚ 8.0â­           â”‚  â”‚ 7.9â­           â”‚
â”‚ 1999            â”‚  â”‚ 2003            â”‚  â”‚ 2009            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚
â”‚  [POSTER]       â”‚  â”‚  [POSTER]       â”‚  â”‚  [POSTER]       â”‚
â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚
â”‚ Inception       â”‚  â”‚ Interstellar    â”‚  â”‚ Titanic         â”‚
â”‚ Netflix         â”‚  â”‚ Netflix         â”‚  â”‚ Disney+         â”‚
â”‚ 8.8â­           â”‚  â”‚ 8.6â­           â”‚  â”‚ 7.3â­           â”‚
â”‚ 2010            â”‚  â”‚ 2014            â”‚  â”‚ 1997            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ‘† Scroll derecha para ver mÃ¡s
```

---

## ğŸ”Œ INTEGRACIÃ“N TÃ‰CNICA

### CÃ³digo en `app/(tabs)/index.tsx`

```typescript
// Estado para pelÃ­culas de plataformas
const [platformMovies, setPlatformMovies] = useState<Movie[]>([]);
const [platformPage, setPlatformPage] = useState(1);

// En loadData()
try {
  console.log(`ğŸ“ Fetch by platforms: ${API_URL}/api/movies/user/${user.id}/by-platforms`);
  const platformRes = await fetchWithTimeout(
    `${API_URL}/api/movies/user/${user.id}/by-platforms?page=${platformPage}`,
    8000
  );
  const platformData = await platformRes.json();
  console.log("ğŸ“± Platform movies:", platformData.movies?.length || 0);
  setPlatformMovies(platformPage === 1 
    ? (platformData.movies || []) 
    : [...platformMovies, ...(platformData.movies || [])]
  );
} catch (error) {
  console.error("âŒ Error loading platform movies:", error);
}

// En JSX render
{!searchQuery && platformMovies.length > 0 && (
  <View style={styles.section}>
    <Text style={styles.sectionTitle}>En tus plataformas</Text>
    <Text style={styles.sectionSubtitle}>Disponibles para ti</Text>
    <ScrollView
      horizontal
      showsHorizontalScrollIndicator={false}
      style={styles.carouselContainer}
    >
      {platformMovies.slice(0, 6).map((movie) => (
        <MovieCard
          key={movie.id}
          movie={movie}
          onPress={() => handleMovieSelect(movie)}
          isFavorite={favorites.has(movie.id)}
          onFavoritePress={() => toggleFavorite(movie)}
        />
      ))}
    </ScrollView>
  </View>
)}
```

---

## ğŸ¨ ESTILOS VISUALES

### SecciÃ³n "En tus plataformas"

```css
sectionTitle: {
  fontSize: 20,
  fontWeight: "700",
  color: "#FFFFFF",
  marginBottom: 4,
  marginLeft: 12
}

sectionSubtitle: {
  fontSize: 13,
  color: "#B0B0B0",
  marginBottom: 12,
  marginLeft: 12
}

carouselContainer: {
  marginHorizontal: 8,
  marginBottom: 20
}

MovieCard: {
  width: 130,
  height: 195,
  marginRight: 12,
  backgroundColor: "#1A1A1A",
  borderRadius: 8,
  overflow: "hidden",
  borderWidth: 2,
  borderColor: "#333333"
}

MovieCard on Hover: {
  borderColor: "#B20710" (Rojo Neon)
}
```

---

## âœ¨ FLUJO VISUAL COMPLETO

```
APP ABRE
  â†“
User logged in (User 2)
  â†“
HOME SCREEN renderiza
  â†“
useEffect(() => loadData())
  â†“
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ 4 Fetch paralelos:                           â”‚
â”‚ 1. /api/movies/trending                      â”‚
â”‚ 2. /api/movies/ranking                       â”‚
â”‚ 3. /api/movies/genre/18                      â”‚
â”‚ 4. /api/movies/user/2/by-platforms â† NUEVA  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â†“
Backend retorna datos:
  - 10 pelÃ­culas trending
  - 5 mejores ranked
  - X pelÃ­culas de gÃ©nero
  - 17 pelÃ­culas de plataformas âœ…
  â†“
State actualizado:
  [trendingMovies] = 10
  [ranking] = 5
  [genreMovies] = X
  [platformMovies] = 17 âœ…
  â†“
UI re-renders con 4 secciones
  â†“
Usuario ve:
  â”Œâ”€ ğŸ“± PelÃ­culas Trending
  â”œâ”€ ğŸ† Top PelÃ­culas
  â”œâ”€ ğŸ“± EN TUS PLATAFORMAS âœ… NUEVA
  â””â”€ ğŸ“‚ Explorar por GÃ©nero
  â†“
Usuario hace click en pelÃ­cula
  â†“
Modal abre con detalles:
  - TÃ­tulo, sinopsis, rating
  - Plataforma donde estÃ¡ disponible
  - BotÃ³n de agregar a favoritos
  - BotÃ³n de escribir reseÃ±a
  â†“
Usuario interactÃºa y todo funciona
```

---

## ğŸ¯ CASOS DE USO

### Caso 1: Usuario con plataformas seleccionadas
```
User 2 tiene: Disney+ + Netflix
â†’ Ve 17 pelÃ­culas en "En tus plataformas"
â†’ Todas de Netflix o Disney+
â†’ Datos REALES de TMDB
```

### Caso 2: Usuario sin plataformas seleccionadas
```
User 3 no tiene plataformas
â†’ SecciÃ³n "En tus plataformas" NO se muestra
â†’ Solo ve otros contenidos (Trending, Ranking, etc)
```

### Caso 3: Usuario busca
```
searchQuery = "Matrix"
â†’ Busca en toda la BD
â†’ SecciÃ³n "En tus plataformas" se oculta
â†’ Muestra solo resultados de bÃºsqueda
```

---

## ğŸš€ CÃ“MO PROBARLO

### Terminal 1: Iniciar Backend
```powershell
cd C:\popFlix_TFG\backend
node server.js
```

### Terminal 2: Iniciar App
```powershell
cd C:\popFlix_TFG
expo start
```

### TelÃ©fono/Emulador:
```
1. Abre PopFlix
2. Inicia sesiÃ³n con:
   Email: usuario2@example.com
   ContraseÃ±a: pass123
3. O cualquier usuario en BD que tenga plataformas configuradas
4. Â¡Ve la secciÃ³n "En tus plataformas"!
```

---

## ğŸ“Š INTEGRACIÃ“N CON DATOS

### Endpoint Response Real

```json
{
  "movies": [
    {
      "id": 12,
      "title": "The Matrix",
      "rating": 8.7,
      "release_date": "1999-03-30",
      "poster_url": "https://image.tmdb.org/t/p/w500/vfeljQUZj29GlVoNdggFnAwAoIJ.jpg",
      "description": "A computer hacker learns from mysterious rebels...",
      "popularity": 92.5
    },
    {
      "id": 278,
      "title": "The Shawshank Redemption",
      "rating": 8.7,
      "release_date": "1994-10-14",
      "poster_url": "https://image.tmdb.org/t/p/w500/q6y0Go1TSJe7T1fnVQx3tLjtoS8.jpg",
      "description": "Two imprisoned men bond over...",
      "popularity": 85.3
    }
    // ... mÃ¡s pelÃ­culas
  ],
  "count": 17,
  "page": 1,
  "totalPages": 2
}
```

---

**Estado:** âœ… Completamente implementado  
**UbicaciÃ³n en cÃ³digo:** `app/(tabs)/index.tsx` lÃ­neas 129-135, 498-519  
**Base de datos:** 84 pelÃ­culas Ã— 80 asignaciones Ã— 8 plataformas  
**Datos:** 100% reales de TMDB API

---

Â¡La secciÃ³n estÃ¡ lista para que la vea cuando abra la app!
